<!DOCTYPE html>
<html lang="es">

<head>
<meta charset="utf-8" />
<title>Abrir carpeta Xedoc</title>
<link rel="stylesheet" href="css/metro-bootstrap.css">
<link rel="stylesheet" href="css/iconFont.css">
<link rel="stylesheet" href="css/drag.css">
<script src="js/jquery/jquery.min.js"></script>
<script src="js/jquery/jquery.widget.min.js"></script>
<script src="js/metro/metro-button-set.js"></script>
<script src="js/metro/metro.min.js"></script>
<script src="js/metro/metro-hint.js"></script>
<script src="js/metro/metro-input-control.js"></script>
<script src="js/yui-min.js"></script>

<script>function hola(){document.all.ins.click()};</script>
<script type="text/javascript">
	function inicializa(){
		var subido = [0,0,20,0,15,0,0,0,30,0,2,0];
		
		for(var i=1;i<13;i++){
			var nid = "p" + i;
			var nodo = document.getElementById(nid);
			nodo.innerHTML = subido[i-1];
		}
		
	}
	</script>
</head>
<body class="metro" onload="inicializa()">  <!-- onload="hola()" -->

				<div class="row" style="margin: 20px auto 40px 10px">	
					<div class="row" style="float: right; margin-right: 20px;">

							<a class="tile half bg-emerald" title="Enviar a Xedoc" href="command://enviarXedoc">
								<div class="tile-content icon">
									<i class="icon-upload"></i>
								</div>
							</a> 

					</div>
					
					
					<div class="row">

							<h1 class="tile-area-title fg-white" style="float: left; margin: 0 100px 10px 10px; font-size: 40px;">Xedoc</h1>
				
							<a class="tile half bg-crimson"  title="actualizar" id="ins" name="prueba" href="command://firmado">
								<div class="tile-content icon">
									<i class="icon-cycle"></i>
								</div>
							</a>
	
					</div>
					
					<div class="row">

							<a class="tile half bg-yellow" title="Iniciar Altair" href="command://iniciarXedoc">
								<div class="tile-content icon">
									<i class="icon-lightning fg-crimson"></i>
								</div>
							</a> 
							<a class="tile half bg-magenta"  title="Carpeta Xedoc Originales" href="command://carpetaXedocO">
								<div class="tile-content icon">
									<i class="icon-basket"></i>
								</div>
							</a>

					</div>
					
					<br>
					<span class="fg-white">Documentos totales: <strong class="fg-crimson" id="pdfstotales"> 589</strong></span>
					<br>
					<span class="fg-white">Documentos pendientes: <strong class="fg-crimson" id="pdfspendientes"> 209</strong></span>
					

				</div>
				
				
				
				<div id="Xedoc">
				
					<span id="mensajes" style="color: white; display: block;">Aparecen los mensajes</span>
					
					<span id="listaA" style="color: white; display: block;">Vacio</span>
					<span id="listaB" style="color: white; display: block;">Vacio</span>
					<span id="listaC" style="color: white; display: block;">Vacio</span>
									
					<div id="workarea">
						<div class="usuarios">
						    <div class="player" id="u1"><h3 id="Ana" style="color: white;">Ana</h3></div>
						    <div class="player" id="u2"><h3 id="Asun" style="color: white;">Asun</h3></div>
						    <div class="player" id="u3"><h3 id="Conchi" style="color: white;">Conchi</h3></div>
						    <div class="player" id="u4"><h3 id="Esther" style="color: white;">Esther</h3></div>
						    <div class="player" id="u5"><h3 id="Iago" style="color: white;">Iago</h3></div>
						    <div class="player" id="u6"><h3 id="Irene" style="color: white;">Irene</h3></div>
						    <div class="player" id="u7"><h3 id="Isa" style="color: white;">Isa</h3></div>
						    <div class="player" id="u8"><h3 id="Juanma" style="color: white;">Juanma</h3></div>
						    <div class="player" id="u9"><h3 id="Man" style="color: white;">Man</h3></div>
						    <div class="player" id="u10"><h3 id="Oscar" style="color: white;">Oscar</h3></div>
						    <div class="player" id="u11"><h3 id="Salva" style="color: white;">Salva</h3></div>
						    <div class="player" id="u12"><h3 id="Ruben" style="color: white;">Ruben</h3></div>
					    </div>
					    
					    <div class="pendiente">
						    <div class="Pend" id="p1">0</div>
						    <div class="Pend" id="p2">10</div>
						    <div class="Pend" id="p3">0</div>
						    <div class="Pend" id="p4">30</div>
						    <div class="Pend" id="p5">0</div>
						    <div class="Pend" id="p6">15</div>
						    <div class="Pend" id="p7">0</div>
						    <div class="Pend" id="p8">0</div>
						    <div class="Pend" id="p9">21</div>
						    <div class="Pend" id="p10">9</div>
						    <div class="Pend" id="p11">0</div>
						    <div class="Pend" id="p12">0</div>
					    </div>
					    
					    
					    <div class="areaTrabajo">

							<div class= "col">
								<div class="slot" id="b1">vacío</div>
								<div class="suma"><strong id="sum1">55</strong> pdfs.</div>
								<div id="play" class="plai">
								        <ul id="list1" class="yui3-dd-drop">
								        </ul>
								</div>
							</div>
							
							<div class="col">
								<div class="slot" id="b2">vacío</div>
								<div class="suma"><strong id="sum2">55</strong> pdfs.</div>
								<div id="play1" class="plai">
								        <ul id="list2" class="yui3-dd-drop">
										</ul>
								</div>
							</div>
	
	
							<div class="carpetas">
								<div class="slot" id="b3">vacío</div>
								<div class="suma"><strong id="sum3">5</strong> pdfs.</div>
								<div id="play2" class="plai">
								        <ul id="list3" class="yui3-dd-drop">
								        	<li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf01">#453 <span class="pdfs">Ingresos <strong>50</strong></span></li>
								            <li class="list2 yui3-dd-drop yui3-dd-draggable" id="pdf02">#447 <span class="pdfs"><strong>48</strong></span></li>
								            <li class="list2 yui3-dd-drop yui3-dd-draggable" id="pdf03">Item #3</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf04">Item #4</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf05">Item #5</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf06">Item #6</li>
								            <li class="list2 yui3-dd-drop yui3-dd-draggable" id="pdf07">Item #7</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf08">Item #8</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf09">Item #9</li>
								            <li class="list3 yui3-dd-drop yui3-dd-draggable" id="pdf10">#465 <span class="pdfs">Ingresos <strong>78</strong></span></li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf11">Item #11</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf12">Item #12</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf13">Item #13</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf14">Item #14</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf15">Item #15</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf16">Item #16</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf17">Item #17</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf18">Item #18</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf19">Item #19</li>
								            <li class="list1 yui3-dd-drop yui3-dd-draggable" id="pdf20">Item #20</li>
								        </ul>
								</div>
							</div>
						<div>
							
						</div>
					
					
					</div>
					    
					    
					    
					    
					    
					    
					    
					    
					</div>
				

				</div>



	<script type="text/javascript">
	
		YUI().use('dd-drop', 'dd-proxy', 'dd-constrain', function(Y) {
	
			var coordOrigen;
			var quitarUsuarioLista;
			
			
			var listaA = { usuario: ""};
			var listaB = { usuario: ""};
			var listaC = { usuario: ""};
			
			
			var mensajes = document.getElementById('mensajes');
			var submensajes1 = document.getElementById('listaA');
			var submensajes2 = document.getElementById('listaB');
			var submensajes3 = document.getElementById('listaC');
			
			var usuario = "";
			
		    var slots = Y.one('#workarea').all('.slot');
		    
		    
		    Y.each(slots, function(v, k) {
		        var id = v.get('id'), groups = ['one'];

		        var drop = new Y.DD.Drop({
		            node: v,
		            groups: groups
		        });

		    });
			
			
		    var players = Y.one('#workarea').all('.player');
		    Y.each(players, function(v, k) {
		        var id = v.get('id'), groups = ['one'];

		        var drag = new Y.DD.Drag({
		            node: v,
		            groups: groups
		        }).plug(Y.Plugin.DDProxy, {
		            moveOnEnd: false
		        }).plug(Y.Plugin.DDConstrained, {
		            constrain2node: '#workarea'
		        });
		        
		        drag.on('drag:start', function() {
		            var p = this.get('dragNode'),
		                n = this.get('node');
		                n.setStyle('opacity', .25);
		                if (!this._playerStart) {
		                    this._playerStart = this.nodeXY;
		                }
		            
		            var aux = n.get('id');
		            var aux2 = document.getElementById(aux);
		            var aux3 = aux2.getElementsByTagName('h3');
		                
		            p.set('innerHTML',  n.get('innerHTML') );
		            p.setStyles({
		                backgroundColor: n.getStyle('backgroundColor'),
		                color: n.getStyle('color'),
		                opacity: .65
		            });
		            
		            var xy = this.get('node').getXY();
		            coordOrigen = xy;
		            
		            mensajes.innerHTML = "Empezó el arrastre";
		            usuario = aux3[0].id;
		        });
		        
		        drag.on('drag:end', function() {
		            var n = this.get('node');
		            n.setStyle('opacity', '1');
		            var sss = n.get('id');
		            var clave = sss[1];
		            clave = 'p' + clave;
		            document.getElementById('sum1').innerHTML = document.getElementById(clave).innerHTML;
		            
		          //  mensajes.innerHTML = "Terminó el arrastre";
		            
		        });
		        
		        drag.on('drag:drophit', function(e) {
		        	
		        	
		        	var nodus = e.drop.get('node');
		        	var nodoId = nodus.get('id');
		        	
		            
		            
		            
		            

	
		            
			            
		            if(nodoId.indexOf('b1') != -1){
		            	
		            	var aux = document.getElementById('b1');
		            	var auxInner= aux.innerHTML;
		            	
		            	if(auxInner.indexOf('vacío') != -1){
			            	submensajes1.innerHTML = usuario;
			            	listaA.usuario = usuario;
			            	aux.innerHTML = usuario;
			            	
				            var xy = nodus.getXY();
				            this.get('node').setXY(xy);
		            	}
		            }else if(nodoId.indexOf('b2') != -1){
		            	var aux = document.getElementById('b2');
		            	var auxInner= aux.innerHTML;
		            	
		            	if(auxInner.indexOf('vacío') != -1){
			            	submensajes2.innerHTML = usuario;
			            	listaB.usuario = usuario;
			            	aux.innerHTML = usuario;
			            	
				            var xy = nodus.getXY();
				            this.get('node').setXY(xy);
		            	}
		            }else if(nodoId.indexOf('b3') != -1){
		            	var aux = document.getElementById('b3');
		            	var auxInner= aux.innerHTML;
		            	
		            	if(auxInner.indexOf('vacío') != -1){
			            	submensajes3.innerHTML = usuario;
			            	listaC.usuario = usuario;
			            	aux.innerHTML = usuario;
			            	
				            var xy = nodus.getXY();
				            this.get('node').setXY(xy);
		            	}
		            }
		            

		            
		            mensajes.innerHTML = "Arrastre terminado con éxito.";
		            
		            
		         //  	submensajes1.innerHTML = this.get('node').get('innerHTML');
		         //	submensajes1.innerHTML = nodus.get('innerHTML');
		        });
		        
		        
		        drag.on('drag:dropmiss', function(e) {
		            if (this._playerStart) {
		            	
		            	
			            var nodoId = this.get('node').get('id');

			            
			            var aux2 = document.getElementById(nodoId);
			            var aux3 = aux2.getElementsByTagName('h3');
			            
			            var aux4 = document.getElementById('b1');
			            
			            if(aux4.innerHTML.indexOf(aux3[0].id) != -1){
			            	aux4.innerHTML = 'vacío';
			            }
		            	
			            var aux4 = document.getElementById('b2');
			            
			            if(aux4.innerHTML.indexOf(aux3[0].id) != -1){
			            	aux4.innerHTML = 'vacío';
			            }
			            
			            var aux4 = document.getElementById('b3');
			            
			            if(aux4.innerHTML.indexOf(aux3[0].id) != -1){
			            	aux4.innerHTML = 'vacío';
			            }
			            
		            	/*
		            	var aux0 = this.get('node');
		            	var pos = aux0.getStyle('position');
		            	var top = aux0.getStyle('top');
		            	var left = aux0.getStyle('left');
		            
		            	
		            	alert(pos + ' ' + top + ' ' + left);
		            	
						*/
		            	
		                this.get('node').setXY(this._playerStart, Y.UA.ie);
		                var con = this.get('node').getXY();
		                this._playerStart = null;
		                
		                this.get('node').setStyles(
								{
									position : 'relative',
									left: '0px',
									top: '0px'
								});
		                
		                mensajes.innerHTML = "Arrastre terminado con fracaso.";
						
		            }
		        });
		    });
		});
	
	
	</script>

	<script type="text/javascript">
		YUI().use(
				'dd-constrain',
				'dd-proxy',
				'dd-drop',
				'dd-scroll',
				function(Y) {
					//Listen for all drop:over events
					//Y.DD.DDM._debugShim = true;

					Y.DD.DDM.on('drop:over', function(e) {
						//Get a reference to our drag and drop nodes
						var drag = e.drag.get('node'), drop = e.drop
								.get('node');

						//Are we dropping on a li node?
						if (drop.get('tagName').toLowerCase() === 'li') {
							//Are we not going up?
							if (!goingUp) {
								drop = drop.get('nextSibling');
							}
							//Add the node to this list
							e.drop.get('node').get('parentNode').insertBefore(
									drag, drop);
							//Set the new parentScroll on the nodescroll plugin
							e.drag.nodescroll.set('parentScroll', e.drop.get(
									'node').get('parentNode'));
							//Resize this nodes shim, so we can drop on it later.
							e.drop.sizeShim();
						}
					});
					//Listen for all drag:drag events
					Y.DD.DDM.on('drag:drag', function(e) {
						//Get the last y point
						var y = e.target.lastXY[1];
						//is it greater than the lastY var?
						if (y < lastY) {
							//We are going up
							goingUp = true;
						} else {
							//We are going down.
							goingUp = false;
						}
						//Cache for next check
						lastY = y;
						Y.DD.DDM.syncActiveShims(true);
					});
					//Listen for all drag:start events
					Y.DD.DDM.on('drag:start', function(e) {
						//Get our drag object
						var drag = e.target;
						//Set some styles here
						drag.get('node').setStyle('opacity', '.25');
						drag.get('dragNode').set('innerHTML',
								drag.get('node').get('innerHTML'));
						drag.get('dragNode').setStyles(
								{
									opacity : '.5',
									borderColor : drag.get('node').getStyle(
											'borderColor'),
									backgroundColor : drag.get('node')
											.getStyle('backgroundColor')
								});
					});
					//Listen for a drag:end events
					Y.DD.DDM.on('drag:end', function(e) {
						var drag = e.target;
						//Put our styles back
						drag.get('node').setStyles({
							visibility : '',
							opacity : '1'
						});
					});
					//Listen for all drag:drophit events
					Y.DD.DDM.on('drag:drophit', function(e) {
						var drop = e.drop.get('node'), drag = e.drag
								.get('node');

						//if we are not on an li, we must have been dropped on a ul
						if (drop.get('tagName').toLowerCase() !== 'li') {
							if (!drop.contains(drag)) {
								drop.appendChild(drag);
								//Set the new parentScroll on the nodescroll plugin
								e.drag.nodescroll.set('parentScroll', e.drop
										.get('node'));
							}
						}
					});

					//Static Vars
					var goingUp = false, lastY = 0;

					//Get the list of li's in the lists and make them draggable
					var lis = Y.all('.plai ul li');
					lis.each(function(v, k) {
						var dd = new Y.DD.Drag({
							node : v,
							target : {
								padding : '0 0 0 20'
							}
						}).plug(Y.Plugin.DDProxy, {
							moveOnEnd : false
					/*	}).plug(Y.Plugin.DDConstrained, {
							constrain2node : '.plai'  */
						}).plug(Y.Plugin.DDNodeScroll, {
							node : v.get('parentNode')
						});
					});

					//Create simple targets for the 2 lists.
					var uls = Y.all('.plai ul');
					uls.each(function(v, k) {
						var tar = new Y.DD.Drop({
							node : v
						});
					});

				});
	</script>


</body>
</html>